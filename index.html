<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>System Solar - VR</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
</head>

<body>
    <a-scene>
        <a-assets>
            <audio id="background-music" src="audio/pad-space-travel-hyperdrive-engine-humming-235901.mp3"></audio>
            <img id="sunText" src="img/sun.jpg">
            <img id="earthText" src="img/earth.jpg">
            <img id="marsText" src="img/mars.jpg">
            <img id="venusText" src="img/venus_atmosphere.jpg">
            <img id="mercuryText" src="img/mercury.jpg">
            <img id="jupiterText" src="img/jupiter.jpg">
            <img id="saturnText" src="img/saturn.jpg">
            <img id="uranusText" src="img/uranus.jpg">
            <img id="neptuneText" src="img/neptune.jpg">
            <img id="saturnRingText" src="img/saturn_ring_alpha.png">
            <img id="skyText" src="img/stars.jpg">
        </a-assets>

        <!-- Som de fundo tocando automaticamente -->
        <a-sound id="sound" src="audio/pad-space-travel-hyperdrive-engine-humming-235901.mp3" position="0 0 0" autoplay="true" loop="true" volume="1"></a-sound>

        <a-entity id="vr-modal" position="0 0 -3" visible="false">
            <a-plane width="8" height="4" color="#000" material="opacity: 0.9" position="0 0 0"></a-plane>
            <a-text id="vr-modal-title" value="" position="0 1.2 0" align="center" width="7" color="#FFD700"></a-text>
            <a-text id="vr-modal-content" value="" position="0 -0.3 0" align="center" width="6.5" color="#FFF"></a-text>
        </a-entity>

        <a-sky src="#skyText"></a-sky>
        <a-light type="ambient" color="#555"></a-light>


        <!-- Sun -->
        <a-entity id="sun" geometry="primitive: sphere; radius:12;" position="0 1.25 -15"
            material="shader: flat; src: #sunText"
            animation="property: rotation; to: 0 -360 0; easing: linear; loop: true; dur: 200000">
        </a-entity>

        <!-- Mercury -->
        <a-entity position="0 1.25 -5" rotation="0 20 0"
            animation="property: rotation; to: 0 360 0; easing: linear; loop: true; dur: 18000">
            <a-entity id="mercury" geometry="primitive: sphere; radius:.2;" position="8 0 0"
                material="src: #mercuryText" class="planet"
                data-info="Mercúrio:\nO menor planeta.\nDistância do Sol: 57.9M km\nPeríodo Orbital: 88 dias">
            </a-entity>
        </a-entity>

        <!-- Venus -->
        <a-entity position="0 1.25 -5" rotation="0 -60 0"
            animation="property: rotation; to: 0 360 0; easing: linear; loop: true; dur: 24000">
            <a-entity id="venus" geometry="primitive: sphere; radius:.4;" position="10 0 0" material="src: #venusText"
                class="planet"
                data-info="Vênus:\nO planeta mais quente.\nDistância do Sol: 108.2M km\nPeríodo Orbital: 225 dias">
            </a-entity>
        </a-entity>

        <!-- Earth -->
        <a-entity position="0 1.25 -5" rotation="0 -60 0"
            animation="property: rotation; to: 0 300 0; easing: linear; loop: true; dur: 24000">
            <a-entity id="earth" geometry="primitive: sphere; radius:.6;" position="12 0 0"
                material="src: #earthText; roughness: 0.8; metalness: 0.2" class="planet"
                data-info="Terra:\nO Planeta Azul.\nDistância do Sol: 150M km\nPeríodo Orbital: 365 dias">
            </a-entity>
        </a-entity>

        <!-- Mars -->
        <a-entity position="0 1.25 -5" rotation="0 -20 0"
            animation="property: rotation; to: 0 340 0; easing: linear; loop: true; dur: 27000">
            <a-entity id="mars" geometry="primitive: sphere; radius:.3;" position="14 0 0" material="src: #marsText"
                class="planet"
                data-info="Marte:\nO Planeta Vermelho.\nDistância do Sol: 228M km\nPeríodo Orbital: 687 dias">
            </a-entity>
        </a-entity>

        <!-- Jupiter -->
        <a-entity position="0 1.25 -5" rotation="0 0 0"
            animation="property: rotation; to: 0 360 0; easing: linear; loop: true; dur: 32000">
            <a-entity id="jupiter" geometry="primitive: sphere; radius:2;" position="18 0 0"
                material="src: #jupiterText" class="planet"
                data-info="Júpiter:\nO maior planeta.\nDistância do Sol: 778M km\nPeríodo Orbital: 12 anos">
            </a-entity>
        </a-entity>

        <!-- Saturn -->
        <a-entity position="0 1.25 -5" rotation="0 40 0"
            animation="property: rotation; to: 0 400 0; easing: linear; loop: true; dur: 35000">
            <a-entity id="saturn" geometry="primitive: sphere; radius:1.4;" position="22 0 0"
                material="src: #saturnText" class="planet"
                data-info="Saturno:\nConhecido por seus anéis.\nDistância do Sol: 1.43B km\nPeríodo Orbital: 29 anos">
                <a-ring position="0 0 0" rotation="-90 0 0" radius-inner="1.6" radius-outer="2.4"
                    material="src: #saturnRingText"></a-ring>
            </a-entity>
        </a-entity>

        <!-- Uranus -->
        <a-entity position="0 1.25 -5" rotation="0 100 0"
            animation="property: rotation; to: 0 400 0; easing: linear; loop: true; dur: 45000">
            <a-entity id="uranus" geometry="primitive: sphere; radius:1;" position="26 0 0" material="src: #uranusText"
                class="planet"
                data-info="Urano:\nUm gigante de gelo.\nDistância do Sol: 2.87B km\nPeríodo Orbital: 84 anos">
            </a-entity>
        </a-entity>

        <!-- Neptune -->
        <a-entity position="0 1.25 -5" rotation="0 120 0"
            animation="property: rotation; to: 0 360 0; easing: linear; loop: true; dur: 60000">
            <a-entity id="neptune" geometry="primitive: sphere; radius:.8;" position="30 0 0"
                material="src: #neptuneText" class="planet"
                data-info="Netuno:\nO planeta mais ventoso.\nDistância do Sol: 4.5B km\nPeríodo Orbital: 165 anos">
            </a-entity>
        </a-entity>

        <!-- Navigation Arrows -->
        <a-entity id="navigation-arrows" position="0 1.5 1">
            <a-image src="img/arrow-up.png" position="0 0.5 0" rotation="0 0 0" scale="0.7 0.7 0.7" class="nav-arrow" data-direction="up"></a-image>
            <a-image src="img/arrow-down.png" position="0 -0.5 0" rotation="0 0 0" scale="0.7 0.7 0.7" class="nav-arrow" data-direction="down"></a-image>
            <a-image src="img/arrow-left.png" position="-0.5 0 0" rotation="0 0 0" scale="0.7 0.7 0.7" class="nav-arrow" data-direction="left"></a-image>
            <a-image src="img/arrow-right.png" position="0.5 0 0" rotation="0 0 0" scale="0.7 0.7 0.7" class="nav-arrow" data-direction="right"></a-image>
            <a-image src="img/arrow-forward.png" position="1 0 0" rotation="0 0 0" scale="0.7 0.7 0.7" class="nav-arrow" data-direction="forward"></a-image>
            <a-image src="img/arrow-backward.png" position="-1 0 0" rotation="0 0 0" scale="0.7 0.7 0.7" class="nav-arrow" data-direction="backward"></a-image>
        </a-entity>

         <!-- Text para informações dos planetas -->
        <a-entity id="info" position="0 3 -2" text="value: ; color: white; width: 25;"></a-entity>

        <!-- Câmera e cursor -->
        <a-camera id="camera" position="0 1.6 15" wasd-controls-enabled="true" look-controls="true">
            <a-cursor fuse="true" fuse-timeout="1000" raycaster="objects: .planet, .nav-arrow"
                material="color: yellow; shader: flat;">
            </a-cursor>
        </a-camera>
    </a-scene>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const scene = document.querySelector('a-scene');
            const camera = document.getElementById('camera');
            const planets = document.querySelectorAll('.planet');
            const vrModal = document.getElementById('vr-modal');
            const vrModalTitle = document.getElementById('vr-modal-title');
            const vrModalContent = document.getElementById('vr-modal-content');

            // Posição do Sol no espaço
            const sunPosition = new THREE.Vector3(0, 1.25, -15);

            // Função para calcular a distância entre o planeta e o Sol
            function isPlanetInFrontOfSun(planet) {
                const planetPosition = new THREE.Vector3();
                planet.object3D.getWorldPosition(planetPosition);
                return planetPosition.z > sunPosition.z;
            }

            // Função para abrir o modal VR
            function openVRModal(title, content, planet) {
                if (isPlanetInFrontOfSun(planet)) {
                    const position = planet.object3D.getWorldPosition(new THREE.Vector3());

                    vrModalTitle.setAttribute('value', title);
                    vrModalContent.setAttribute('value', content);

                    const modalPosition = {
                        x: position.x + 1,
                        y: position.y + 1.5,
                        z: position.z
                    };

                    vrModal.setAttribute('position', `${modalPosition.x} ${modalPosition.y} ${modalPosition.z}`);
                    vrModal.setAttribute('visible', true);

                    vrModal.setAttribute('animation', {
                        property: 'position',
                        to: `${modalPosition.x} ${modalPosition.y} ${modalPosition.z}`,
                        easing: 'easeInOutCubic',
                        dur: 500
                    });
                }
            }

            // Fechar o modal VR
            function closeVRModal() {
                vrModal.setAttribute('visible', false);
            }

            // Evento para cada planeta
            planets.forEach(planet => {
                planet.addEventListener('click', () => {
                    const info = planet.getAttribute('data-info');
                    const [title, ...details] = info.split('\n');
                    openVRModal(title, details.join('\n'), planet);
                });
            });

            const navArrows = document.querySelectorAll('.nav-arrow');

            // Função para mover a câmera suavemente
            function moveCamera(direction) {
                const position = camera.getAttribute('position');
                const moveDistance = 0.5; // Distância reduzida para controle mais fino
                const duration = 500; // Duração da animação em milissegundos

                let newPosition = { ...position };

                switch (direction) {
                    case 'up':
                        newPosition.y += moveDistance;
                        break;
                    case 'down':
                        newPosition.y -= moveDistance;
                        break;
                    case 'left':
                        newPosition.x -= moveDistance;
                        break;
                    case 'right':
                        newPosition.x += moveDistance;
                        break;
                    case 'forward':
                        newPosition.z -= moveDistance;
                        break;
                    case 'backward':
                        newPosition.z += moveDistance;
                        break;
                }

                camera.setAttribute('animation', {
                    property: 'position',
                    to: `${newPosition.x} ${newPosition.y} ${newPosition.z}`,
                    easing: 'easeInOutQuad',
                    dur: duration
                });
            }

            // Evento para cada seta de navegação
            navArrows.forEach(arrow => {
                arrow.addEventListener('click', () => {
                    const direction = arrow.getAttribute('data-direction');
                    moveCamera(direction);
                });
            });

            // Função para ajustar o zoom
            function adjustZoomForVR(isVR) {
                if (isVR) {
                    camera.setAttribute('zoom', 0.5); // Ajuste este valor conforme necessário
                } else {
                    camera.setAttribute('zoom', 1); // Valor padrão
                }
            }

            // Função para ajustar a posição da câmera
            function adjustCameraPositionForVR(isVR) {
                if (isVR) {
                    camera.setAttribute('position', {x: 0, y: 1.6, z: 20}); // Distância maior para VR
                } else {
                    camera.setAttribute('position', {x: 0, y: 1.6, z: 15});
                }
            }

            // Evento quando entrar no modo VR
            scene.addEventListener('enter-vr', () => {
                adjustZoomForVR(true);
                adjustCameraPositionForVR(true);
            });

            // Evento quando sair do modo VR
            scene.addEventListener('exit-vr', () => {
                adjustZoomForVR(false);
                adjustCameraPositionForVR(false);
            });
        });
    </script>
</body>

</html>